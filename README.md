# MonoBooks
msw monorepo example with nx, vite, graphql-mesh, nestjs

<a href="https://nx.dev" target="_blank" rel="noreferrer"><img src="https://raw.githubusercontent.com/nrwl/nx/master/images/nx-logo.png" width="45"></a>

✨ **This workspace has been generated by [Nx, a Smart, fast and extensible build system.](https://nx.dev)** ✨

## Getting started
터미널을 열고 workspace root 경로에서 `yarn` 명령 실행    

### books-service running (REST, GQL)
터미널을 열고 다음 커맨드를 실행하여 books-service:mesh-start 태스크를 실행한다.    
`yarn nx run books-service:mesh-start`  

위 명령은 다음의 내용들을 절차대로 수행하며 REST, GQL을 한 번에 서비스 한다.    

1. nestjs 의 REST 서비스를 http://localhost:3333/api 로 실행한다. 이 때 Swagger Docs가 http://localhost:3333/docs로 서비스 되며, 이 문서를 토대로 Open Api Specification(OAS) 을 따르는 json 파일이 생성 된다.
2. 1번에서 생성 된 OAS json파일을 타겟으로 하여 mesh build 명령이 실행된다. 이 명령은 OAS를 통합 graphql schema를 만들어낸다.
3. 2번에서 생성된 통합 graphql schema가 있는 .mesh/ 디렉터리를 타겟으로 mesh start 명령이 실행되며 http://localhost:4000/graphql 로 서비스한다. 브라우저에서 http://localhost:4000 으로 접속하면 Yoga GraphiQL 플레이그라운드를 이용할 수 있다.  

### books app running (development)
터미널을 열고 다음 커맨드를 실행하여 books:serve:development 태스크를 실행한다.  
`yarn nx run books:serve`  
또는  
`yarn nx run books:serve:development`

브라우저에서 http://localhost:4200 으로 접속하고 개발자도구의 network탭을 열어보면 msw 서비스워커에 의해 api가 모킹 되는 것을 확인 할 수 있다.  
때문에 books-service 가 실행되지 않더라도 앱이 정상동작한다.  

### books app running (production)
터미널을 열고 다음 커맨드를 실행하여 books:serve:development 태스크를 실행한다.  
`yarn nx run books:serve:production`

브라우저에서 http://localhost:4200 으로 접속하고 개발자도구의 network탭을 열어보면 books-service 의해 REST 및 GQL api가 서비스 되는 것을 확인 할 수 있다.  

## Understand this workspace

Run `yarn nx graph` to see a diagram of the dependencies of the projects.

## Further help

Visit the [Nx Documentation](https://nx.dev) to learn more.
